@using DbNetSuiteCore.Enums
@using DbNetSuiteCore.Models
@using DbNetSuiteCore.Samples.Helpers
@model DbNetSuiteCore.Samples.ViewModels.SampleModel
@section Title
{
    <p data-summary>The contents can be filtered using the FixedFilter and FixedFilterParameters properties. The FixedFilterParameters values can be updated from the client side using the updateFixedFilterParameters client-side method</p>
}
@section Control {
@{
        <div style="display:flex;flex-direction:column;gap: 4px;">
            <div style="display:flex;flex-direction:row;gap: 4px;">
                <div>
                    <label style="margin-left:5px">Discontinued</label>
                </div>
                <div>
                    <label><input type="checkbox" id="discontinued" /></label>
                </div>
            </div>
            <div>
                @(await DbNetSuiteCore.Control.Create(Context).Render(Model.TreeModel))
            </div>
            <div>
                @(await DbNetSuiteCore.Control.Create(Context).Render(Model.FormModel))
            </div>
        </div>
}}

@section Scripts
{
<script type="text/javascript" class="source">
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelector('input[type="checkbox"]').addEventListener('change', updateTree);
    });

    function saveTreeReference(sender) {
        window.categoryProductTree = sender;
    }
    function saveFormReference(sender) {
        window.productForm = sender;

    }
    function updateTree(event) {
        const isChecked = event.target.checked;
        window.categoryProductTree.updateFixedFilterParameters({discontinued : isChecked ? 1 : 0});
        window.productForm.updateFixedFilterParameters({productid : -1})
    }

    function productSelected(sender, args) {
        if (window.productForm)
        {
                window.productForm.updateFixedFilterParameters({productid : args.value})
        }
    }
</script>
}
